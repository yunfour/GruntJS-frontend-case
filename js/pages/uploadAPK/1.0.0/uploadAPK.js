/*! gruntTest 2014-09-19 */
define("pages/uploadAPK/1.0.0/template",[],function(){var a=['<p class="upload-apk-progress-info">',"<span>$${fileName}</span>","{@if !message}",'<span class="upload-apk-progress-percent">上传中 $${percent}%</span>',"{@/if}","</p>",'<div class="com-progress {@if message} com-progress-grey {@/if}">','<div class="com-progress-bd" style="width: ${percent}%;"></div>',"</div>",'<p class="upload-apk-progress-speed">',"{@if percent == 100}",'<span style="color:#4bc577">上传完成</span>',"{@else if speed}","<span>$${uploaded}M/$${size}M $${speed}k/s</span>","{@/if}","{@if message}",'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color: #e52617;">$${message}</span>&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:;" class="J-retryBtn">重试</a>',"{@/if}","</p>"].join("");return a}),define("pages/uploadAPK/1.0.0/uploadAPK",["$","gallery/upload/1.1.1/upload","gallery/juicer/0.6.5/juicer","common/tools/0.0.1/tools","components/tip/0.0.1/tip","components/progress/0.0.1/progress","./template"],function(a){function b(a,b){var c=j.decimalPlace(p.getAttr("percent"),2),d=p.getAttr("cumulateTime"),e={fileName:s.name||"",size:j.decimalPlace((s.size||419430.4)/1048576,2),percent:c};a&&(e.message=b),e.uploaded=j.decimalPlace(e.size*c/100,2),e.speed=j.decimalPlace(1024*e.uploaded/(d/1e3),2),o.html(m.render(e))}function c(a){var b=/\.(apk)$/i.test(a);return b}function d(a,b,c){if(e||(e=new k({theme:"red",arrowPosition:7})),f&&window.clearTimeout(f),a){var d=b.offset();c='<div style="width:175px">'+c+"</div>",e.setTipText(c).setPosition(d.left+59,d.top-2).show(),f=window.setTimeout(function(){e.hide()},3e3)}else e.hide()}var e,f,g=a("$"),h=a("gallery/upload/1.1.1/upload"),i=a("gallery/juicer/0.6.5/juicer"),j=a("common/tools/0.0.1/tools"),k=a("components/tip/0.0.1/tip"),l=a("components/progress/0.0.1/progress"),m=a("./template"),n=g("#J-progress"),o=n.children("div.upload-apk-progress-bd"),p=new l,q=g("#J-selectBtn"),r=g("#J-uploadBtn"),s=[],t=new h({trigger:q,name:"screenshot",action:"./jsp/uploadAPK.jsp",multiple:!1,data:{r:Math.random()},change:function(a){return c(a[0].name)?(r.removeClass("com-btn-disable"),void(s=a[0])):(d(!0,q,"文件格式必须为 *.apk"),!1)},error:function(){p.pause(),t._uploaders[0].refreshInput(),b(!0,"上传出错请重试"),r.removeClass("com-btn-disable")},success:function(a){var c=g.parseJSON(a);t._uploaders[0].refreshInput(),"1"===c.status?p.finish():(p.pause(),b(!0,c.message),r.removeClass("com-btn-disable"))}}),u=t._uploaders[0].form;m=i(m),p.on("progress",function(){b()}),r.on("click",function(){return r.hasClass("com-btn-disable")?!1:(t.submit(),p.restart(),q.hide(),n.show(),u.hide(),t.disable(),void r.addClass("com-btn-disable"))}),n.delegate("a.upload-apk-progress-reselection","click",function(){p.stop(),n.hide(),q.show(),u.show(),t.enable(),t._uploaders[0].refreshInput()}),n.delegate("a.J-retryBtn","click",function(){r.click()})});